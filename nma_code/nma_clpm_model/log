2023-02-03 19:42:22.466961: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2023-02-03 19:42:22,516: WARNING tensorflow 140199343417152 Deprecation warnings have been disabled. Set TF_ENABLE_DEPRECATION_WARNINGS=1 to re-enable them.
tensorflow version: 1.15.4, git_version: v1.15.4-788-gef094748fe, compiler_version: 5.3.1 20160406 (Red Hat 5.3.1-6), cxx11_abi_flag: 0, monolithic_build: 0
2023-02-03 19:42:23,812: WARNING tensorflow 140199343417152 From main.py:7: The name tf.logging.set_verbosity is deprecated. Please use tf.compat.v1.logging.set_verbosity instead.

2023-02-03 19:42:23,812: WARNING tensorflow 140199343417152 From main.py:7: The name tf.logging.INFO is deprecated. Please use tf.compat.v1.logging.INFO instead.

2023-02-03 19:42:23,812: WARNING tensorflow 140199343417152 From main.py:8: The name tf.ConfigProto is deprecated. Please use tf.compat.v1.ConfigProto instead.

2023-02-03 19:42:23,812: INFO tensorflow 140199343417152 [Meituan Context] job_name is set to worker
2023-02-03 19:42:23,813: INFO tensorflow 140199343417152 Using config: {'_model_dir': '../model/listwise_clpm_model_b', '_tf_random_seed': 2021, '_save_summary_steps': 100, '_save_checkpoints_steps': 1000, '_save_checkpoints_secs': None, '_session_config': gpu_options {
  allow_growth: true
}
allow_soft_placement: true
, '_keep_checkpoint_max': 2, '_keep_checkpoint_every_n_hours': 10000, '_log_step_count_steps': 1000, '_train_distribute': None, '_device_fn': None, '_protocol': None, '_eval_distribute': None, '_experimental_distribute': None, '_experimental_max_worker_delay_secs': None, '_session_creation_timeout_secs': 7200, '_chief_training': True, '_persistent_metric': False, '_shut_ratio': 1.0, '_slow_worker_delay_ratio': 1.5, '_delete_worker_session_timeout_secs': 120, '_service': None, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f822e1247f0>, '_task_type': 'worker', '_task_id': 0, '_global_id_in_cluster': 0, '_master': '', '_evaluation_master': '', '_is_chief': True, '_num_ps_replicas': 0, '_num_worker_replicas': 1}
2023-02-03 19:42:23,813: WARNING tensorflow 140199343417152 Estimator's model_fn (<bound method DNN.model_fn_estimator of <model.DNN object at 0x7f822e10eb70>>) includes params argument, but params are not passed to Estimator.
************************************************** DATA_INPUT START!!!! **************************************************
################################################## DATA_INPUT END... time lapsing 0:00:00.000005  ##################################################
************************************************** PREDICT START!!!! **************************************************
2023-02-03 19:42:23,863: WARNING tensorflow 140199343417152 
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

2023-02-03 19:42:24,244: INFO tensorflow 140199343417152 BatchDs size:1024, drop:0
2023-02-03 19:42:24,301: WARNING tensorflow 140199343417152 From /usr/local/lib64/python3.6/site-packages/tensorflow_core/python/autograph/converters/directives.py:119: The name tf.parse_example is deprecated. Please use tf.io.parse_example instead.

2023-02-03 19:42:24,388: WARNING tensorflow 140199343417152 From /usr/local/lib64/python3.6/site-packages/tensorflow_core/python/autograph/converters/directives.py:119: The name tf.FixedLenFeature is deprecated. Please use tf.io.FixedLenFeature instead.

2023-02-03 19:42:24,558: WARNING tensorflow 140199343417152 From /usr/local/lib64/python3.6/site-packages/tensorflow_core/python/autograph/converters/directives.py:119: The name tf.mod is deprecated. Please use tf.math.mod instead.

2023-02-03 19:42:25,199: INFO tensorflow 140199343417152 Calling model_fn.
2023-02-03 19:42:25,199: WARNING tensorflow 140199343417152 From /mnt/dolphinfs/hdd_pool/docker/user/hadoop-hmart-waimaiad/yangfan129/nma_code/listwise_clpm_model/model.py:104: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

d_model 8
2023-02-03 19:42:25,210: WARNING tensorflow 140199343417152 From /mnt/dolphinfs/hdd_pool/docker/user/hadoop-hmart-waimaiad/yangfan129/nma_code/listwise_clpm_model/layers.py:54: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2023-02-03 19:42:25,210: WARNING tensorflow 140199343417152 From /mnt/dolphinfs/hdd_pool/docker/user/hadoop-hmart-waimaiad/yangfan129/nma_code/listwise_clpm_model/layers.py:54: The name tf.AUTO_REUSE is deprecated. Please use tf.compat.v1.AUTO_REUSE instead.

output_mask Tensor("dnn_model/multihead_attention/scaled_dot_product_attention/truediv:0", shape=(?, 3, 3), dtype=float32)
key_masks Tensor("dnn_model/multihead_attention/scaled_dot_product_attention/Tile_1:0", shape=(?, ?, 3), dtype=float32)
inputs Tensor("dnn_model/multihead_attention/scaled_dot_product_attention/truediv:0", shape=(?, 3, 3), dtype=float32)
2023-02-03 19:42:25,279: WARNING tensorflow 140199343417152 From /mnt/dolphinfs/hdd_pool/docker/user/hadoop-hmart-waimaiad/yangfan129/nma_code/listwise_clpm_model/layers.py:152: The name tf.summary.image is deprecated. Please use tf.compat.v1.summary.image instead.

d_model 8
output_mask Tensor("dnn_model/target_att/scaled_dot_product_attention/truediv:0", shape=(?, 5, 3), dtype=float32)
2023-02-03 19:42:25,510: WARNING tensorflow 140199343417152 From /mnt/dolphinfs/hdd_pool/docker/user/hadoop-hmart-waimaiad/yangfan129/nma_code/listwise_clpm_model/model.py:197: The name tf.losses.sigmoid_cross_entropy is deprecated. Please use tf.compat.v1.losses.sigmoid_cross_entropy instead.

2023-02-03 19:42:25,564: WARNING tensorflow 140199343417152 From /mnt/dolphinfs/hdd_pool/docker/user/hadoop-hmart-waimaiad/yangfan129/nma_code/listwise_clpm_model/model.py:207: The name tf.saved_model.signature_constants.DEFAULT_SERVING_SIGNATURE_DEF_KEY is deprecated. Please use tf.saved_model.DEFAULT_SERVING_SIGNATURE_DEF_KEY instead.

2023-02-03 19:42:25,564: INFO tensorflow 140199343417152 Done calling model_fn.
2023-02-03 19:42:25,643: INFO tensorflow 140199343417152 Graph was finalized.
2023-02-03 19:42:25.653623: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2295620000 Hz
2023-02-03 19:42:25.655196: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5a92460 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2023-02-03 19:42:25.655215: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2023-02-03 19:42:25.657745: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2023-02-03 19:42:25.898452: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5af2410 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2023-02-03 19:42:25.898490: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): NVIDIA A100-SXM4-80GB, Compute Capability 8.0
2023-02-03 19:42:25.902174: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1665] Found device 0 with properties: 
name: NVIDIA A100-SXM4-80GB major: 8 minor: 0 memoryClockRate(GHz): 1.41
pciBusID: 0000:51:00.0
2023-02-03 19:42:25.902212: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2023-02-03 19:42:25.905949: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2023-02-03 19:42:25.907176: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2023-02-03 19:42:25.907383: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2023-02-03 19:42:25.910596: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2023-02-03 19:42:25.911372: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2023-02-03 19:42:25.911481: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2023-02-03 19:42:25.917804: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1793] Adding visible gpu devices: 0
2023-02-03 19:42:25.917830: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2023-02-03 19:42:26.237937: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1206] Device interconnect StreamExecutor with strength 1 edge matrix:
2023-02-03 19:42:26.237967: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1212]      0 
2023-02-03 19:42:26.237972: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1225] 0:   N 
2023-02-03 19:42:26.244507: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1351] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 79191 MB memory) -> physical GPU (device: 0, name: NVIDIA A100-SXM4-80GB, pci bus id: 0000:51:00.0, compute capability: 8.0)
2023-02-03 19:42:26,249: INFO tensorflow 140199343417152 Restoring parameters from ../model/listwise_clpm_model_b/model.ckpt-20449
2023-02-03 19:42:26.271818: I tensorflow/core/common_runtime/placer.cc:249] Total node count 1178
2023-02-03 19:42:26.271846: I tensorflow/core/common_runtime/placer.cc:254] Device (/job:localhost/replica:0/task:0/device:CPU:0) got 14.52% of nodes
2023-02-03 19:42:26.271851: I tensorflow/core/common_runtime/placer.cc:254] Device (/job:localhost/replica:0/task:0/device:GPU:0) got 85.31% of nodes
2023-02-03 19:42:26,910: INFO tensorflow 140199343417152 Running local_init_op.
2023-02-03 19:42:26,925: INFO tensorflow 140199343417152 Done running local_init_op.
2023-02-03 19:42:27.163460: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2023-02-03 19:42:27.951809: I tensorflow/core/common_runtime/placer.cc:249] Total node count 8
2023-02-03 19:42:27.951842: I tensorflow/core/common_runtime/placer.cc:254] Device (/job:localhost/replica:0/task:0/device:CPU:0) got 75.00% of nodes
2023-02-03 19:42:27.957130: I tensorflow/core/common_runtime/placer.cc:249] Total node count 49
2023-02-03 19:42:27.957144: I tensorflow/core/common_runtime/placer.cc:254] Device (/job:localhost/replica:0/task:0/device:CPU:0) got 95.92% of nodes
2023-02-03 19:42:27.960442: I ./tensorflow/core/lib/afo/afo_wrapper.h:73] Hang watcher running .
2023-02-03 19:42:27.962150: I tensorflow/core/common_runtime/placer.cc:249] Total node count 7
2023-02-03 19:42:27.962164: I tensorflow/core/common_runtime/placer.cc:249] Total node count 7
2023-02-03 19:42:27.962164: I tensorflow/core/common_runtime/placer.cc:249] Total node count 7
2023-02-03 19:42:27.962200: I tensorflow/core/common_runtime/placer.cc:254] Device (/job:localhost/replica:0/task:0/device:CPU:0) got 71.43% of nodes
2023-02-03 19:42:27.962201: I tensorflow/core/common_runtime/placer.cc:254] Device (/job:localhost/replica:0/task:0/device:CPU:0) got 71.43% of nodes
2023-02-03 19:42:27.962166: I tensorflow/core/common_runtime/placer.cc:254] Device (/job:localhost/replica:0/task:0/device:CPU:0) got 71.43% of nodes
2023-02-03 19:42:27.962332: I tensorflow/core/common_runtime/placer.cc:249] Total node count 7
2023-02-03 19:42:27.962375: I tensorflow/core/common_runtime/placer.cc:254] Device (/job:localhost/replica:0/task:0/device:CPU:0) got 71.43% of nodes
2023-02-03 19:42:27.962528: I tensorflow/core/common_runtime/placer.cc:249] Total node count 7
2023-02-03 19:42:27.962551: I tensorflow/core/common_runtime/placer.cc:254] Device (/job:localhost/replica:0/task:0/device:CPU:0) got 71.43% of nodes
2023-02-03 19:42:27.962630: I tensorflow/core/common_runtime/placer.cc:249] Total node count 7
2023-02-03 19:42:27.962630: I tensorflow/core/common_runtime/placer.cc:249] Total node count 7
2023-02-03 19:42:27.962651: I tensorflow/core/common_runtime/placer.cc:254] Device (/job:localhost/replica:0/task:0/device:CPU:0) got 71.43% of nodes
2023-02-03 19:42:27.962652: I tensorflow/core/common_runtime/placer.cc:254] Device (/job:localhost/replica:0/task:0/device:CPU:0) got 71.43% of nodes
2023-02-03 19:42:27.962164: I tensorflow/core/common_runtime/placer.cc:249] Total node count 7
2023-02-03 19:42:27.962875: I tensorflow/core/common_runtime/placer.cc:254] Device (/job:localhost/replica:0/task:0/device:CPU:0) got 71.43% of nodes
2023-02-03 19:42:27.962935: I tensorflow/core/common_runtime/placer.cc:249] Total node count 7
2023-02-03 19:42:27.962954: I tensorflow/core/common_runtime/placer.cc:254] Device (/job:localhost/replica:0/task:0/device:CPU:0) got 71.43% of nodes
2023-02-03 19:42:27.962954: I tensorflow/core/common_runtime/placer.cc:249] Total node count 7
2023-02-03 19:42:27.962995: I tensorflow/core/common_runtime/placer.cc:254] Device (/job:localhost/replica:0/task:0/device:CPU:0) got 71.43% of nodes
2023-02-03 19:42:27.986226: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2023-02-03 19:42:37.938813: I ./tensorflow/core/util/simple_watcher.h:177] IterResource report:{{PrefetchWait:costs:5723.073779ms,times:1435007}}.
2023-02-03 19:42:47.942509: I ./tensorflow/core/util/simple_watcher.h:177] IterResource report:{{PrefetchWait:costs:7157.491424ms,times:1613800}}.
2023-02-03 19:42:57.943804: I ./tensorflow/core/util/simple_watcher.h:177] IterResource report:{{PrefetchWait:costs:7178.570180ms,times:1684562}}.
2023-02-03 19:43:00,888: INFO tensorflow 140199343417152 _MonitoredSession __exit__ with <class 'tensorflow.python.framework.errors_impl.OutOfRangeError'>
2023-02-03 19:43:00,888: INFO tensorflow 140199343417152 _MonitoredSession starts close with exception None
auc:0.7615660697572539
################################################## PREDICT END... time lapsing 0:00:44.105963  ##################################################
